{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.MongoLogger = exports.stringifyWithMaxLen = exports.createStdioLogger = exports.MongoLoggableComponent = exports.SEVERITY_LEVEL_MAP = exports.DEFAULT_MAX_DOCUMENT_LENGTH = exports.SeverityLevel = void 0;\nconst bson_1 = require(\"bson\");\nconst util_1 = require(\"util\");\nconst constants_1 = require(\"./constants\");\nconst utils_1 = require(\"./utils\");\n/** @internal */\nexports.SeverityLevel = Object.freeze({\n  EMERGENCY: 'emergency',\n  ALERT: 'alert',\n  CRITICAL: 'critical',\n  ERROR: 'error',\n  WARNING: 'warn',\n  NOTICE: 'notice',\n  INFORMATIONAL: 'info',\n  DEBUG: 'debug',\n  TRACE: 'trace',\n  OFF: 'off'\n});\n/** @internal */\nexports.DEFAULT_MAX_DOCUMENT_LENGTH = 1000;\n/** @internal */\nclass SeverityLevelMap extends Map {\n  constructor(entries) {\n    const newEntries = [];\n    for (const [level, value] of entries) {\n      newEntries.push([value, level]);\n    }\n    newEntries.push(...entries);\n    super(newEntries);\n  }\n  getNumericSeverityLevel(severity) {\n    return this.get(severity);\n  }\n  getSeverityLevelName(level) {\n    return this.get(level);\n  }\n}\n/** @internal */\nexports.SEVERITY_LEVEL_MAP = new SeverityLevelMap([[exports.SeverityLevel.OFF, -Infinity], [exports.SeverityLevel.EMERGENCY, 0], [exports.SeverityLevel.ALERT, 1], [exports.SeverityLevel.CRITICAL, 2], [exports.SeverityLevel.ERROR, 3], [exports.SeverityLevel.WARNING, 4], [exports.SeverityLevel.NOTICE, 5], [exports.SeverityLevel.INFORMATIONAL, 6], [exports.SeverityLevel.DEBUG, 7], [exports.SeverityLevel.TRACE, 8]]);\n/** @internal */\nexports.MongoLoggableComponent = Object.freeze({\n  COMMAND: 'command',\n  TOPOLOGY: 'topology',\n  SERVER_SELECTION: 'serverSelection',\n  CONNECTION: 'connection'\n});\n/**\n * Parses a string as one of SeverityLevel\n *\n * @param s - the value to be parsed\n * @returns one of SeverityLevel if value can be parsed as such, otherwise null\n */\nfunction parseSeverityFromString(s) {\n  const validSeverities = Object.values(exports.SeverityLevel);\n  const lowerSeverity = s?.toLowerCase();\n  if (lowerSeverity != null && validSeverities.includes(lowerSeverity)) {\n    return lowerSeverity;\n  }\n  return null;\n}\n/** @internal */\nfunction createStdioLogger(stream) {\n  return {\n    write: log => {\n      stream.write((0, util_1.inspect)(log, {\n        compact: true,\n        breakLength: Infinity\n      }), 'utf-8');\n      return;\n    }\n  };\n}\nexports.createStdioLogger = createStdioLogger;\n/**\n * resolves the MONGODB_LOG_PATH and mongodbLogPath options from the environment and the\n * mongo client options respectively. The mongodbLogPath can be either 'stdout', 'stderr', a NodeJS\n * Writable or an object which has a `write` method with the signature:\n * ```ts\n * write(log: Log): void\n * ```\n *\n * @returns the MongoDBLogWritable object to write logs to\n */\nfunction resolveLogPath(_ref, _ref2) {\n  let {\n    MONGODB_LOG_PATH\n  } = _ref;\n  let {\n    mongodbLogPath\n  } = _ref2;\n  if (typeof mongodbLogPath === 'string' && /^stderr$/i.test(mongodbLogPath)) {\n    return createStdioLogger(process.stderr);\n  }\n  if (typeof mongodbLogPath === 'string' && /^stdout$/i.test(mongodbLogPath)) {\n    return createStdioLogger(process.stdout);\n  }\n  if (typeof mongodbLogPath === 'object' && typeof mongodbLogPath?.write === 'function') {\n    return mongodbLogPath;\n  }\n  if (MONGODB_LOG_PATH && /^stderr$/i.test(MONGODB_LOG_PATH)) {\n    return createStdioLogger(process.stderr);\n  }\n  if (MONGODB_LOG_PATH && /^stdout$/i.test(MONGODB_LOG_PATH)) {\n    return createStdioLogger(process.stdout);\n  }\n  return createStdioLogger(process.stderr);\n}\nfunction compareSeverity(s0, s1) {\n  const s0Num = exports.SEVERITY_LEVEL_MAP.getNumericSeverityLevel(s0);\n  const s1Num = exports.SEVERITY_LEVEL_MAP.getNumericSeverityLevel(s1);\n  return s0Num < s1Num ? -1 : s0Num > s1Num ? 1 : 0;\n}\n/** @internal */\nfunction stringifyWithMaxLen(value, maxDocumentLength) {\n  const ejson = bson_1.EJSON.stringify(value);\n  return maxDocumentLength !== 0 && ejson.length > maxDocumentLength ? `${ejson.slice(0, maxDocumentLength)}...` : ejson;\n}\nexports.stringifyWithMaxLen = stringifyWithMaxLen;\nfunction isLogConvertible(obj) {\n  const objAsLogConvertible = obj;\n  // eslint-disable-next-line no-restricted-syntax\n  return objAsLogConvertible.toLog !== undefined && typeof objAsLogConvertible.toLog === 'function';\n}\nfunction attachCommandFields(log, commandEvent) {\n  log.commandName = commandEvent.commandName;\n  log.requestId = commandEvent.requestId;\n  log.driverConnectionId = commandEvent?.connectionId;\n  const {\n    host,\n    port\n  } = utils_1.HostAddress.fromString(commandEvent.address).toHostPort();\n  log.serverHost = host;\n  log.serverPort = port;\n  if (commandEvent?.serviceId) {\n    log.serviceId = commandEvent.serviceId.toHexString();\n  }\n  return log;\n}\nfunction attachConnectionFields(log, connectionPoolEvent) {\n  const {\n    host,\n    port\n  } = utils_1.HostAddress.fromString(connectionPoolEvent.address).toHostPort();\n  log.serverHost = host;\n  log.serverPort = port;\n  return log;\n}\nfunction defaultLogTransform(logObject) {\n  let maxDocumentLength = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : exports.DEFAULT_MAX_DOCUMENT_LENGTH;\n  let log = Object.create(null);\n  switch (logObject.name) {\n    case constants_1.COMMAND_STARTED:\n      log = attachCommandFields(log, logObject);\n      log.message = 'Command started';\n      log.command = stringifyWithMaxLen(logObject.command, maxDocumentLength);\n      log.databaseName = logObject.databaseName;\n      return log;\n    case constants_1.COMMAND_SUCCEEDED:\n      log = attachCommandFields(log, logObject);\n      log.message = 'Command succeeded';\n      log.durationMS = logObject.duration;\n      log.reply = stringifyWithMaxLen(logObject.reply, maxDocumentLength);\n      return log;\n    case constants_1.COMMAND_FAILED:\n      log = attachCommandFields(log, logObject);\n      log.message = 'Command failed';\n      log.durationMS = logObject.duration;\n      log.failure = logObject.failure;\n      return log;\n    case constants_1.CONNECTION_POOL_CREATED:\n      log = attachConnectionFields(log, logObject);\n      log.message = 'Connection pool created';\n      if (logObject.options) {\n        const {\n          maxIdleTimeMS,\n          minPoolSize,\n          maxPoolSize,\n          maxConnecting,\n          waitQueueTimeoutMS\n        } = logObject.options;\n        log = {\n          ...log,\n          maxIdleTimeMS,\n          minPoolSize,\n          maxPoolSize,\n          maxConnecting,\n          waitQueueTimeoutMS\n        };\n      }\n      return log;\n    case constants_1.CONNECTION_POOL_READY:\n      log = attachConnectionFields(log, logObject);\n      log.message = 'Connection pool ready';\n      return log;\n    case constants_1.CONNECTION_POOL_CLEARED:\n      log = attachConnectionFields(log, logObject);\n      log.message = 'Connection pool cleared';\n      if (logObject.serviceId?._bsontype === 'ObjectId') {\n        log.serviceId = logObject.serviceId.toHexString();\n      }\n      return log;\n    case constants_1.CONNECTION_POOL_CLOSED:\n      log = attachConnectionFields(log, logObject);\n      log.message = 'Connection pool closed';\n      return log;\n    case constants_1.CONNECTION_CREATED:\n      log = attachConnectionFields(log, logObject);\n      log.message = 'Connection created';\n      log.driverConnectionId = logObject.connectionId;\n      return log;\n    case constants_1.CONNECTION_READY:\n      log = attachConnectionFields(log, logObject);\n      log.message = 'Connection ready';\n      log.driverConnectionId = logObject.connectionId;\n      return log;\n    case constants_1.CONNECTION_CLOSED:\n      log = attachConnectionFields(log, logObject);\n      log.message = 'Connection closed';\n      log.driverConnectionId = logObject.connectionId;\n      switch (logObject.reason) {\n        case 'stale':\n          log.reason = 'Connection became stale because the pool was cleared';\n          break;\n        case 'idle':\n          log.reason = 'Connection has been available but unused for longer than the configured max idle time';\n          break;\n        case 'error':\n          log.reason = 'An error occurred while using the connection';\n          if (logObject.error) {\n            log.error = logObject.error;\n          }\n          break;\n        case 'poolClosed':\n          log.reason = 'Connection pool was closed';\n          break;\n        default:\n          log.reason = `Unknown close reason: ${logObject.reason}`;\n      }\n      return log;\n    case constants_1.CONNECTION_CHECK_OUT_STARTED:\n      log = attachConnectionFields(log, logObject);\n      log.message = 'Connection checkout started';\n      return log;\n    case constants_1.CONNECTION_CHECK_OUT_FAILED:\n      log = attachConnectionFields(log, logObject);\n      log.message = 'Connection checkout failed';\n      switch (logObject.reason) {\n        case 'poolClosed':\n          log.reason = 'Connection pool was closed';\n          break;\n        case 'timeout':\n          log.reason = 'Wait queue timeout elapsed without a connection becoming available';\n          break;\n        case 'connectionError':\n          log.reason = 'An error occurred while trying to establish a new connection';\n          if (logObject.error) {\n            log.error = logObject.error;\n          }\n          break;\n        default:\n          log.reason = `Unknown close reason: ${logObject.reason}`;\n      }\n      return log;\n    case constants_1.CONNECTION_CHECKED_OUT:\n      log = attachConnectionFields(log, logObject);\n      log.message = 'Connection checked out';\n      log.driverConnectionId = logObject.connectionId;\n      return log;\n    case constants_1.CONNECTION_CHECKED_IN:\n      log = attachConnectionFields(log, logObject);\n      log.message = 'Connection checked in';\n      log.driverConnectionId = logObject.connectionId;\n      return log;\n    default:\n      for (const [key, value] of Object.entries(logObject)) {\n        if (value != null) log[key] = value;\n      }\n  }\n  return log;\n}\n/** @internal */\nclass MongoLogger {\n  constructor(options) {\n    /**\n     * This method should be used when logging errors that do not have a public driver API for\n     * reporting errors.\n     */\n    this.error = this.log.bind(this, 'error');\n    /**\n     * This method should be used to log situations where undesirable application behaviour might\n     * occur. For example, failing to end sessions on `MongoClient.close`.\n     */\n    this.warn = this.log.bind(this, 'warn');\n    /**\n     * This method should be used to report high-level information about normal driver behaviour.\n     * For example, the creation of a `MongoClient`.\n     */\n    this.info = this.log.bind(this, 'info');\n    /**\n     * This method should be used to report information that would be helpful when debugging an\n     * application. For example, a command starting, succeeding or failing.\n     */\n    this.debug = this.log.bind(this, 'debug');\n    /**\n     * This method should be used to report fine-grained details related to logic flow. For example,\n     * entering and exiting a function body.\n     */\n    this.trace = this.log.bind(this, 'trace');\n    this.componentSeverities = options.componentSeverities;\n    this.maxDocumentLength = options.maxDocumentLength;\n    this.logDestination = options.logDestination;\n  }\n  log(severity, component, message) {\n    if (compareSeverity(severity, this.componentSeverities[component]) > 0) return;\n    let logMessage = {\n      t: new Date(),\n      c: component,\n      s: severity\n    };\n    if (typeof message === 'string') {\n      logMessage.message = message;\n    } else if (typeof message === 'object') {\n      if (isLogConvertible(message)) {\n        logMessage = {\n          ...logMessage,\n          ...message.toLog()\n        };\n      } else {\n        logMessage = {\n          ...logMessage,\n          ...defaultLogTransform(message, this.maxDocumentLength)\n        };\n      }\n    }\n    this.logDestination.write(logMessage);\n  }\n  /**\n   * Merges options set through environment variables and the MongoClient, preferring environment\n   * variables when both are set, and substituting defaults for values not set. Options set in\n   * constructor take precedence over both environment variables and MongoClient options.\n   *\n   * @remarks\n   * When parsing component severity levels, invalid values are treated as unset and replaced with\n   * the default severity.\n   *\n   * @param envOptions - options set for the logger from the environment\n   * @param clientOptions - options set for the logger in the MongoClient options\n   * @returns a MongoLoggerOptions object to be used when instantiating a new MongoLogger\n   */\n  static resolveOptions(envOptions, clientOptions) {\n    // client options take precedence over env options\n    const combinedOptions = {\n      ...envOptions,\n      ...clientOptions,\n      mongodbLogPath: resolveLogPath(envOptions, clientOptions)\n    };\n    const defaultSeverity = parseSeverityFromString(combinedOptions.MONGODB_LOG_ALL) ?? exports.SeverityLevel.OFF;\n    return {\n      componentSeverities: {\n        command: parseSeverityFromString(combinedOptions.MONGODB_LOG_COMMAND) ?? defaultSeverity,\n        topology: parseSeverityFromString(combinedOptions.MONGODB_LOG_TOPOLOGY) ?? defaultSeverity,\n        serverSelection: parseSeverityFromString(combinedOptions.MONGODB_LOG_SERVER_SELECTION) ?? defaultSeverity,\n        connection: parseSeverityFromString(combinedOptions.MONGODB_LOG_CONNECTION) ?? defaultSeverity,\n        default: defaultSeverity\n      },\n      maxDocumentLength: (0, utils_1.parseUnsignedInteger)(combinedOptions.MONGODB_LOG_MAX_DOCUMENT_LENGTH) ?? 1000,\n      logDestination: combinedOptions.mongodbLogPath\n    };\n  }\n}\nexports.MongoLogger = MongoLogger;","map":{"version":3,"names":["bson_1","require","util_1","constants_1","utils_1","exports","SeverityLevel","Object","freeze","EMERGENCY","ALERT","CRITICAL","ERROR","WARNING","NOTICE","INFORMATIONAL","DEBUG","TRACE","OFF","DEFAULT_MAX_DOCUMENT_LENGTH","SeverityLevelMap","Map","constructor","entries","newEntries","level","value","push","getNumericSeverityLevel","severity","get","getSeverityLevelName","SEVERITY_LEVEL_MAP","Infinity","MongoLoggableComponent","COMMAND","TOPOLOGY","SERVER_SELECTION","CONNECTION","parseSeverityFromString","s","validSeverities","values","lowerSeverity","toLowerCase","includes","createStdioLogger","stream","write","log","inspect","compact","breakLength","resolveLogPath","_ref","_ref2","MONGODB_LOG_PATH","mongodbLogPath","test","process","stderr","stdout","compareSeverity","s0","s1","s0Num","s1Num","stringifyWithMaxLen","maxDocumentLength","ejson","EJSON","stringify","length","slice","isLogConvertible","obj","objAsLogConvertible","toLog","undefined","attachCommandFields","commandEvent","commandName","requestId","driverConnectionId","connectionId","host","port","HostAddress","fromString","address","toHostPort","serverHost","serverPort","serviceId","toHexString","attachConnectionFields","connectionPoolEvent","defaultLogTransform","logObject","arguments","create","name","COMMAND_STARTED","message","command","databaseName","COMMAND_SUCCEEDED","durationMS","duration","reply","COMMAND_FAILED","failure","CONNECTION_POOL_CREATED","options","maxIdleTimeMS","minPoolSize","maxPoolSize","maxConnecting","waitQueueTimeoutMS","CONNECTION_POOL_READY","CONNECTION_POOL_CLEARED","_bsontype","CONNECTION_POOL_CLOSED","CONNECTION_CREATED","CONNECTION_READY","CONNECTION_CLOSED","reason","error","CONNECTION_CHECK_OUT_STARTED","CONNECTION_CHECK_OUT_FAILED","CONNECTION_CHECKED_OUT","CONNECTION_CHECKED_IN","key","MongoLogger","bind","warn","info","debug","trace","componentSeverities","logDestination","component","logMessage","t","Date","c","resolveOptions","envOptions","clientOptions","combinedOptions","defaultSeverity","MONGODB_LOG_ALL","MONGODB_LOG_COMMAND","topology","MONGODB_LOG_TOPOLOGY","serverSelection","MONGODB_LOG_SERVER_SELECTION","connection","MONGODB_LOG_CONNECTION","default","parseUnsignedInteger","MONGODB_LOG_MAX_DOCUMENT_LENGTH"],"sources":["C:\\Users\\kin_v\\OneDrive\\Documents\\Orbital\\orbital-code\\node_modules\\mongodb\\src\\mongo_logger.ts"],"sourcesContent":["import { EJSON } from 'bson';\nimport type { Writable } from 'stream';\nimport { inspect } from 'util';\n\nimport type {\n  CommandFailedEvent,\n  CommandStartedEvent,\n  CommandSucceededEvent\n} from './cmap/command_monitoring_events';\nimport type {\n  ConnectionCheckedInEvent,\n  ConnectionCheckedOutEvent,\n  ConnectionCheckOutFailedEvent,\n  ConnectionCheckOutStartedEvent,\n  ConnectionClosedEvent,\n  ConnectionCreatedEvent,\n  ConnectionPoolClearedEvent,\n  ConnectionPoolClosedEvent,\n  ConnectionPoolCreatedEvent,\n  ConnectionPoolMonitoringEvent,\n  ConnectionPoolReadyEvent,\n  ConnectionReadyEvent\n} from './cmap/connection_pool_events';\nimport {\n  COMMAND_FAILED,\n  COMMAND_STARTED,\n  COMMAND_SUCCEEDED,\n  CONNECTION_CHECK_OUT_FAILED,\n  CONNECTION_CHECK_OUT_STARTED,\n  CONNECTION_CHECKED_IN,\n  CONNECTION_CHECKED_OUT,\n  CONNECTION_CLOSED,\n  CONNECTION_CREATED,\n  CONNECTION_POOL_CLEARED,\n  CONNECTION_POOL_CLOSED,\n  CONNECTION_POOL_CREATED,\n  CONNECTION_POOL_READY,\n  CONNECTION_READY\n} from './constants';\nimport { HostAddress, parseUnsignedInteger } from './utils';\n\n/** @internal */\nexport const SeverityLevel = Object.freeze({\n  EMERGENCY: 'emergency',\n  ALERT: 'alert',\n  CRITICAL: 'critical',\n  ERROR: 'error',\n  WARNING: 'warn',\n  NOTICE: 'notice',\n  INFORMATIONAL: 'info',\n  DEBUG: 'debug',\n  TRACE: 'trace',\n  OFF: 'off'\n} as const);\n\n/** @internal */\nexport const DEFAULT_MAX_DOCUMENT_LENGTH = 1000;\n/** @internal */\nexport type SeverityLevel = (typeof SeverityLevel)[keyof typeof SeverityLevel];\n\n/** @internal */\nclass SeverityLevelMap extends Map<SeverityLevel | number, SeverityLevel | number> {\n  constructor(entries: [SeverityLevel | number, SeverityLevel | number][]) {\n    const newEntries: [number | SeverityLevel, SeverityLevel | number][] = [];\n    for (const [level, value] of entries) {\n      newEntries.push([value, level]);\n    }\n\n    newEntries.push(...entries);\n    super(newEntries);\n  }\n\n  getNumericSeverityLevel(severity: SeverityLevel): number {\n    return this.get(severity) as number;\n  }\n\n  getSeverityLevelName(level: number): SeverityLevel | undefined {\n    return this.get(level) as SeverityLevel | undefined;\n  }\n}\n\n/** @internal */\nexport const SEVERITY_LEVEL_MAP = new SeverityLevelMap([\n  [SeverityLevel.OFF, -Infinity],\n  [SeverityLevel.EMERGENCY, 0],\n  [SeverityLevel.ALERT, 1],\n  [SeverityLevel.CRITICAL, 2],\n  [SeverityLevel.ERROR, 3],\n  [SeverityLevel.WARNING, 4],\n  [SeverityLevel.NOTICE, 5],\n  [SeverityLevel.INFORMATIONAL, 6],\n  [SeverityLevel.DEBUG, 7],\n  [SeverityLevel.TRACE, 8]\n]);\n\n/** @internal */\nexport const MongoLoggableComponent = Object.freeze({\n  COMMAND: 'command',\n  TOPOLOGY: 'topology',\n  SERVER_SELECTION: 'serverSelection',\n  CONNECTION: 'connection'\n} as const);\n\n/** @internal */\nexport type MongoLoggableComponent =\n  (typeof MongoLoggableComponent)[keyof typeof MongoLoggableComponent];\n\n/** @internal */\nexport interface MongoLoggerEnvOptions {\n  /** Severity level for command component */\n  MONGODB_LOG_COMMAND?: string;\n  /** Severity level for topology component */\n  MONGODB_LOG_TOPOLOGY?: string;\n  /** Severity level for server selection component */\n  MONGODB_LOG_SERVER_SELECTION?: string;\n  /** Severity level for CMAP */\n  MONGODB_LOG_CONNECTION?: string;\n  /** Default severity level to be if any of the above are unset */\n  MONGODB_LOG_ALL?: string;\n  /** Max length of embedded EJSON docs. Setting to 0 disables truncation. Defaults to 1000. */\n  MONGODB_LOG_MAX_DOCUMENT_LENGTH?: string;\n  /** Destination for log messages. Must be 'stderr', 'stdout'. Defaults to 'stderr'. */\n  MONGODB_LOG_PATH?: string;\n}\n\n/** @internal */\nexport interface MongoLoggerMongoClientOptions {\n  /** Destination for log messages */\n  mongodbLogPath?: 'stdout' | 'stderr' | MongoDBLogWritable;\n}\n\n/** @internal */\nexport interface MongoLoggerOptions {\n  componentSeverities: {\n    /** Severity level for command component */\n    command: SeverityLevel;\n    /** Severity level for topology component */\n    topology: SeverityLevel;\n    /** Severity level for server selection component */\n    serverSelection: SeverityLevel;\n    /** Severity level for connection component */\n    connection: SeverityLevel;\n    /** Default severity level to be used if any of the above are unset */\n    default: SeverityLevel;\n  };\n\n  /** Max length of embedded EJSON docs. Setting to 0 disables truncation. Defaults to 1000. */\n  maxDocumentLength: number;\n  /** Destination for log messages. */\n  logDestination: Writable | MongoDBLogWritable;\n}\n\n/**\n * Parses a string as one of SeverityLevel\n *\n * @param s - the value to be parsed\n * @returns one of SeverityLevel if value can be parsed as such, otherwise null\n */\nfunction parseSeverityFromString(s?: string): SeverityLevel | null {\n  const validSeverities: string[] = Object.values(SeverityLevel);\n  const lowerSeverity = s?.toLowerCase();\n\n  if (lowerSeverity != null && validSeverities.includes(lowerSeverity)) {\n    return lowerSeverity as SeverityLevel;\n  }\n\n  return null;\n}\n\n/** @internal */\nexport function createStdioLogger(stream: {\n  write: NodeJS.WriteStream['write'];\n}): MongoDBLogWritable {\n  return {\n    write: (log: Log): unknown => {\n      stream.write(inspect(log, { compact: true, breakLength: Infinity }), 'utf-8');\n      return;\n    }\n  };\n}\n\n/**\n * resolves the MONGODB_LOG_PATH and mongodbLogPath options from the environment and the\n * mongo client options respectively. The mongodbLogPath can be either 'stdout', 'stderr', a NodeJS\n * Writable or an object which has a `write` method with the signature:\n * ```ts\n * write(log: Log): void\n * ```\n *\n * @returns the MongoDBLogWritable object to write logs to\n */\nfunction resolveLogPath(\n  { MONGODB_LOG_PATH }: MongoLoggerEnvOptions,\n  { mongodbLogPath }: { mongodbLogPath?: string | Writable | MongoDBLogWritable }\n): MongoDBLogWritable {\n  if (typeof mongodbLogPath === 'string' && /^stderr$/i.test(mongodbLogPath)) {\n    return createStdioLogger(process.stderr);\n  }\n  if (typeof mongodbLogPath === 'string' && /^stdout$/i.test(mongodbLogPath)) {\n    return createStdioLogger(process.stdout);\n  }\n\n  if (typeof mongodbLogPath === 'object' && typeof mongodbLogPath?.write === 'function') {\n    return mongodbLogPath;\n  }\n\n  if (MONGODB_LOG_PATH && /^stderr$/i.test(MONGODB_LOG_PATH)) {\n    return createStdioLogger(process.stderr);\n  }\n  if (MONGODB_LOG_PATH && /^stdout$/i.test(MONGODB_LOG_PATH)) {\n    return createStdioLogger(process.stdout);\n  }\n\n  return createStdioLogger(process.stderr);\n}\n\n/** @internal */\nexport interface Log extends Record<string, any> {\n  t: Date;\n  c: MongoLoggableComponent;\n  s: SeverityLevel;\n  message?: string;\n}\n\n/** @internal */\nexport interface MongoDBLogWritable {\n  write(log: Log): void;\n}\n\nfunction compareSeverity(s0: SeverityLevel, s1: SeverityLevel): 1 | 0 | -1 {\n  const s0Num = SEVERITY_LEVEL_MAP.getNumericSeverityLevel(s0);\n  const s1Num = SEVERITY_LEVEL_MAP.getNumericSeverityLevel(s1);\n\n  return s0Num < s1Num ? -1 : s0Num > s1Num ? 1 : 0;\n}\n\n/** @internal */\nexport type LoggableEvent =\n  | CommandStartedEvent\n  | CommandSucceededEvent\n  | CommandFailedEvent\n  | ConnectionPoolCreatedEvent\n  | ConnectionPoolReadyEvent\n  | ConnectionPoolClosedEvent\n  | ConnectionPoolClearedEvent\n  | ConnectionCreatedEvent\n  | ConnectionReadyEvent\n  | ConnectionClosedEvent\n  | ConnectionCheckedInEvent\n  | ConnectionCheckedOutEvent\n  | ConnectionCheckOutStartedEvent\n  | ConnectionCheckOutFailedEvent;\n\n/** @internal */\nexport interface LogConvertible extends Record<string, any> {\n  toLog(): Record<string, any>;\n}\n\n/** @internal */\nexport function stringifyWithMaxLen(value: any, maxDocumentLength: number): string {\n  const ejson = EJSON.stringify(value);\n\n  return maxDocumentLength !== 0 && ejson.length > maxDocumentLength\n    ? `${ejson.slice(0, maxDocumentLength)}...`\n    : ejson;\n}\n\n/** @internal */\nexport type Loggable = LoggableEvent | LogConvertible;\n\nfunction isLogConvertible(obj: Loggable): obj is LogConvertible {\n  const objAsLogConvertible = obj as LogConvertible;\n  // eslint-disable-next-line no-restricted-syntax\n  return objAsLogConvertible.toLog !== undefined && typeof objAsLogConvertible.toLog === 'function';\n}\n\nfunction attachCommandFields(\n  log: Record<string, any>,\n  commandEvent: CommandStartedEvent | CommandSucceededEvent | CommandFailedEvent\n) {\n  log.commandName = commandEvent.commandName;\n  log.requestId = commandEvent.requestId;\n  log.driverConnectionId = commandEvent?.connectionId;\n  const { host, port } = HostAddress.fromString(commandEvent.address).toHostPort();\n  log.serverHost = host;\n  log.serverPort = port;\n  if (commandEvent?.serviceId) {\n    log.serviceId = commandEvent.serviceId.toHexString();\n  }\n\n  return log;\n}\n\nfunction attachConnectionFields(\n  log: Record<string, any>,\n  connectionPoolEvent: ConnectionPoolMonitoringEvent\n) {\n  const { host, port } = HostAddress.fromString(connectionPoolEvent.address).toHostPort();\n  log.serverHost = host;\n  log.serverPort = port;\n\n  return log;\n}\n\nfunction defaultLogTransform(\n  logObject: LoggableEvent | Record<string, any>,\n  maxDocumentLength: number = DEFAULT_MAX_DOCUMENT_LENGTH\n): Omit<Log, 's' | 't' | 'c'> {\n  let log: Omit<Log, 's' | 't' | 'c'> = Object.create(null);\n\n  switch (logObject.name) {\n    case COMMAND_STARTED:\n      log = attachCommandFields(log, logObject);\n      log.message = 'Command started';\n      log.command = stringifyWithMaxLen(logObject.command, maxDocumentLength);\n      log.databaseName = logObject.databaseName;\n      return log;\n    case COMMAND_SUCCEEDED:\n      log = attachCommandFields(log, logObject);\n      log.message = 'Command succeeded';\n      log.durationMS = logObject.duration;\n      log.reply = stringifyWithMaxLen(logObject.reply, maxDocumentLength);\n      return log;\n    case COMMAND_FAILED:\n      log = attachCommandFields(log, logObject);\n      log.message = 'Command failed';\n      log.durationMS = logObject.duration;\n      log.failure = logObject.failure;\n      return log;\n    case CONNECTION_POOL_CREATED:\n      log = attachConnectionFields(log, logObject);\n      log.message = 'Connection pool created';\n      if (logObject.options) {\n        const { maxIdleTimeMS, minPoolSize, maxPoolSize, maxConnecting, waitQueueTimeoutMS } =\n          logObject.options;\n        log = {\n          ...log,\n          maxIdleTimeMS,\n          minPoolSize,\n          maxPoolSize,\n          maxConnecting,\n          waitQueueTimeoutMS\n        };\n      }\n      return log;\n    case CONNECTION_POOL_READY:\n      log = attachConnectionFields(log, logObject);\n      log.message = 'Connection pool ready';\n      return log;\n    case CONNECTION_POOL_CLEARED:\n      log = attachConnectionFields(log, logObject);\n      log.message = 'Connection pool cleared';\n      if (logObject.serviceId?._bsontype === 'ObjectId') {\n        log.serviceId = logObject.serviceId.toHexString();\n      }\n      return log;\n    case CONNECTION_POOL_CLOSED:\n      log = attachConnectionFields(log, logObject);\n      log.message = 'Connection pool closed';\n      return log;\n    case CONNECTION_CREATED:\n      log = attachConnectionFields(log, logObject);\n      log.message = 'Connection created';\n      log.driverConnectionId = logObject.connectionId;\n      return log;\n    case CONNECTION_READY:\n      log = attachConnectionFields(log, logObject);\n      log.message = 'Connection ready';\n      log.driverConnectionId = logObject.connectionId;\n      return log;\n    case CONNECTION_CLOSED:\n      log = attachConnectionFields(log, logObject);\n      log.message = 'Connection closed';\n      log.driverConnectionId = logObject.connectionId;\n      switch (logObject.reason) {\n        case 'stale':\n          log.reason = 'Connection became stale because the pool was cleared';\n          break;\n        case 'idle':\n          log.reason =\n            'Connection has been available but unused for longer than the configured max idle time';\n          break;\n        case 'error':\n          log.reason = 'An error occurred while using the connection';\n          if (logObject.error) {\n            log.error = logObject.error;\n          }\n          break;\n        case 'poolClosed':\n          log.reason = 'Connection pool was closed';\n          break;\n        default:\n          log.reason = `Unknown close reason: ${logObject.reason}`;\n      }\n      return log;\n    case CONNECTION_CHECK_OUT_STARTED:\n      log = attachConnectionFields(log, logObject);\n      log.message = 'Connection checkout started';\n      return log;\n    case CONNECTION_CHECK_OUT_FAILED:\n      log = attachConnectionFields(log, logObject);\n      log.message = 'Connection checkout failed';\n      switch (logObject.reason) {\n        case 'poolClosed':\n          log.reason = 'Connection pool was closed';\n          break;\n        case 'timeout':\n          log.reason = 'Wait queue timeout elapsed without a connection becoming available';\n          break;\n        case 'connectionError':\n          log.reason = 'An error occurred while trying to establish a new connection';\n          if (logObject.error) {\n            log.error = logObject.error;\n          }\n          break;\n        default:\n          log.reason = `Unknown close reason: ${logObject.reason}`;\n      }\n      return log;\n    case CONNECTION_CHECKED_OUT:\n      log = attachConnectionFields(log, logObject);\n      log.message = 'Connection checked out';\n\n      log.driverConnectionId = logObject.connectionId;\n      return log;\n    case CONNECTION_CHECKED_IN:\n      log = attachConnectionFields(log, logObject);\n      log.message = 'Connection checked in';\n      log.driverConnectionId = logObject.connectionId;\n      return log;\n    default:\n      for (const [key, value] of Object.entries(logObject)) {\n        if (value != null) log[key] = value;\n      }\n  }\n  return log;\n}\n\n/** @internal */\nexport class MongoLogger {\n  componentSeverities: Record<MongoLoggableComponent, SeverityLevel>;\n  maxDocumentLength: number;\n  logDestination: MongoDBLogWritable | Writable;\n\n  /**\n   * This method should be used when logging errors that do not have a public driver API for\n   * reporting errors.\n   */\n  error = this.log.bind(this, 'error');\n  /**\n   * This method should be used to log situations where undesirable application behaviour might\n   * occur. For example, failing to end sessions on `MongoClient.close`.\n   */\n  warn = this.log.bind(this, 'warn');\n  /**\n   * This method should be used to report high-level information about normal driver behaviour.\n   * For example, the creation of a `MongoClient`.\n   */\n  info = this.log.bind(this, 'info');\n  /**\n   * This method should be used to report information that would be helpful when debugging an\n   * application. For example, a command starting, succeeding or failing.\n   */\n  debug = this.log.bind(this, 'debug');\n  /**\n   * This method should be used to report fine-grained details related to logic flow. For example,\n   * entering and exiting a function body.\n   */\n  trace = this.log.bind(this, 'trace');\n\n  constructor(options: MongoLoggerOptions) {\n    this.componentSeverities = options.componentSeverities;\n    this.maxDocumentLength = options.maxDocumentLength;\n    this.logDestination = options.logDestination;\n  }\n\n  private log(\n    severity: SeverityLevel,\n    component: MongoLoggableComponent,\n    message: Loggable | string\n  ): void {\n    if (compareSeverity(severity, this.componentSeverities[component]) > 0) return;\n\n    let logMessage: Log = { t: new Date(), c: component, s: severity };\n    if (typeof message === 'string') {\n      logMessage.message = message;\n    } else if (typeof message === 'object') {\n      if (isLogConvertible(message)) {\n        logMessage = { ...logMessage, ...message.toLog() };\n      } else {\n        logMessage = { ...logMessage, ...defaultLogTransform(message, this.maxDocumentLength) };\n      }\n    }\n    this.logDestination.write(logMessage);\n  }\n\n  /**\n   * Merges options set through environment variables and the MongoClient, preferring environment\n   * variables when both are set, and substituting defaults for values not set. Options set in\n   * constructor take precedence over both environment variables and MongoClient options.\n   *\n   * @remarks\n   * When parsing component severity levels, invalid values are treated as unset and replaced with\n   * the default severity.\n   *\n   * @param envOptions - options set for the logger from the environment\n   * @param clientOptions - options set for the logger in the MongoClient options\n   * @returns a MongoLoggerOptions object to be used when instantiating a new MongoLogger\n   */\n  static resolveOptions(\n    envOptions: MongoLoggerEnvOptions,\n    clientOptions: MongoLoggerMongoClientOptions\n  ): MongoLoggerOptions {\n    // client options take precedence over env options\n    const combinedOptions = {\n      ...envOptions,\n      ...clientOptions,\n      mongodbLogPath: resolveLogPath(envOptions, clientOptions)\n    };\n    const defaultSeverity =\n      parseSeverityFromString(combinedOptions.MONGODB_LOG_ALL) ?? SeverityLevel.OFF;\n\n    return {\n      componentSeverities: {\n        command: parseSeverityFromString(combinedOptions.MONGODB_LOG_COMMAND) ?? defaultSeverity,\n        topology: parseSeverityFromString(combinedOptions.MONGODB_LOG_TOPOLOGY) ?? defaultSeverity,\n        serverSelection:\n          parseSeverityFromString(combinedOptions.MONGODB_LOG_SERVER_SELECTION) ?? defaultSeverity,\n        connection:\n          parseSeverityFromString(combinedOptions.MONGODB_LOG_CONNECTION) ?? defaultSeverity,\n        default: defaultSeverity\n      },\n      maxDocumentLength:\n        parseUnsignedInteger(combinedOptions.MONGODB_LOG_MAX_DOCUMENT_LENGTH) ?? 1000,\n      logDestination: combinedOptions.mongodbLogPath\n    };\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}